# Claw-Empire v1.0.5 Release Notes

- Release date: 2026-02-19
- Scope: Runtime modularization follow-up, `/api/inbox` webhook security documentation parity, OpenClaw config-path reliability hardening, runtime UX stability fixes, and Skills Library learning-flow integration.

## Highlights

- Continued server decomposition so route/workflow/runtime boundaries are easier to maintain and review in smaller PRs.
- Standardized `/api/inbox` guidance across all README languages:
  - `x-inbox-secret` header is required.
  - header mismatch or omission returns `401`.
- Added one-time auto-migration for existing clones after `git pull`:
  - first `pnpm dev*` / `pnpm start*` run can generate missing `INBOX_WEBHOOK_SECRET`
  - normalizes `OPENCLAW_CONFIG` when needed
  - refreshes AGENTS orchestration rules when stale
  - persists `CLAW_MIGRATION_V1_0_5_DONE=1` to avoid repeated execution
- Expanded AGENTS secret resolution (`INBOX_SECRET_DISCOVERY_V2`) so orchestration can locate `INBOX_WEBHOOK_SECRET` even when running outside the project root:
  - shell env (`INBOX_WEBHOOK_SECRET`)
  - `.env` / `.env.clone` in current working directory or git root
  - common local project paths under home directory
- Improved runtime language consistency (based on selected language setting) across:
  - task run prompts and subtask-plan instructions
  - workflow/status notifications (`in_progress` / `review` / `done`)
  - merge/discard/stop/resume user-facing status messages
  - meeting bubble fallback text and department-name rendering
- Fixed long direct-chat reply truncation in agent conversations:
  - direct one-shot replies now preserve substantially longer content before fallback clipping
  - prevents UI-visible mid-sentence ellipsis for normal long responses
- Fixed repeated phrase cycles in direct 1:1 chat replies:
  - response normalization now collapses repeated sentence patterns such as `A B A B A B`
  - prevents triple/looped apology-like outputs from being posted as-is
- Updated AI Installation Guide and Quick Start to include required `.env` checks for:
  - `INBOX_WEBHOOK_SECRET`
  - `OPENCLAW_CONFIG`
- Clarified OpenClaw setup recommendations:
  - use absolute `OPENCLAW_CONFIG` paths in `.env`
  - unquoted format is preferred in docs for consistency
- Hardened runtime parsing for `OPENCLAW_CONFIG` compatibility:
  - strips surrounding quotes
  - normalizes leading `~` to the user home directory
- Added **Skills Library Learn Squad** flow so users can install skills without leaving the dashboard:
  - each skill card now includes a `Learn` action above `Copy`
  - opening Learn shows one representative NPC per primary CLI provider (`claude`, `codex`, `gemini`, `opencode`)
  - representative selection rule is deterministic: `team_leader > senior > junior > intern`, then higher XP
  - multiple representatives can be selected and started together
- Added background skill-install job APIs for UI-driven installs:
  - `POST /api/skills/learn`
  - `GET /api/skills/learn/:jobId`
  - jobs execute `npx --yes skills@latest add <repo> --yes --agent <...>` and expose status/log tails (`queued`, `running`, `succeeded`, `failed`)
- Added Learn-mode progress UX:
  - live polling of installation job status
  - per-representative learning animation (reading/book-drop effects)
  - command/log visibility in the modal for install traceability

## Problem-Cause Alignment

This patch addresses two high-frequency integration failures reported from real setup flows:

1. Missing `x-inbox-secret` in webhook examples causing `/api/inbox` to reject valid requests.
2. `OPENCLAW_CONFIG` path mismatches caused by quoted values or unresolved `~` in `.env`.

## Documentation Updates (Global)

- `README.md`
- `README_ko.md`
- `README_jp.md`
- `README_zh.md`
- `.env.example`
- `docs/releases/README.md`
- `docs/releases/v1.0.5.md`
- `src/components/SkillsLibrary.tsx`
- `src/api.ts`
- `server/modules/routes/ops.ts`
- `src/index.css`

## Maintenance Notes

- Removed stale release-note phrasing that implied `v1.0.5` was only a potential future patch.
- Removed transient test-result style wording from release-note summaries to keep changelog entries stable.
- Fixed a runtime crash in review orchestration caused by missing workflow context binding (`isTaskWorkflowInterrupted` / `clearTaskWorkflowState`) in `meetings.ts`.
- Closed known runtime/user-impact issues tracked in GitHub:
  - `#11` (`ERR_STREAM_WRITE_AFTER_END`) via safe log-stream write/end guards
  - `#9` (long chat replies cut with `â€¦`) via direct-reply clipping threshold update
